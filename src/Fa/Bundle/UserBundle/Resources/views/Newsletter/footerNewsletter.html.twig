<div class="footer__block footer__block--five">
    <h6 class="footer__title footer-accordion-link">
        Subscribe to our newsletter
    </h6>
    {{ form_start(form, {'attr': {'novalidate': 'novalidate', 'id': 'fa_user_newsletter', 'class': 'footer__form accordion-dropdown' }}) }}
        {{ form_widget(form.email,  { 'attr': {'class': 'footer__form--input', "autocomplete": "off","placeholder" : "Your email"} }) }}
        {{ form_errors(form) }}
        <div class="footer__checkbox custom-checkbox sign-me">
            {{ form_widget(form.email_alert, {'attr': {'class': 'footer__signme--input'}}) }}
            {{ form_label(form.email_alert,'', {'label_attr': {'class': 'footer__checkbox--label'}}) }}
        </div>
        <div class="footer__checkbox custom-checkbox send-me">
            {{ form_widget(form.third_party_email_alert, {'attr': {'class': 'footer__sendme--input'}}) }}
            {{ form_label(form.third_party_email_alert,'', {'label_attr': {'class': 'footer__checkbox--label'}}) }}
        </div>
        <p class="footer__subribe-text">
            You can easily tailor or unsubscribe from our newsletters at any time by clicking on the links at the bottom of each of our emails. You can also update your preferences and personal information at any time.
        </p>
        <div class="footer__subcribe-btn">
            {{ form_widget(form.save,{'attr': {'class': 'btn-rounded footer__subcribe-btn--cta'}}) }}
        </div>
    {{ form_end(form) }}
</div>
        
{% block scriptbottom %}  
<script language="javascript" type="text/javascript">
	$("#fa_user_newsletter_third_party_email_alert").on('click', function (e) {
		if (!$('#fa_user_newsletter_third_party_email_alert').parent('span').hasClass('checked')) {
			$('#fa_user_newsletter_third_party_email_alert').attr('checked', true);
		} else {
			$('#fa_user_newsletter_third_party_email_alert').attr('checked', false);
		}

		if ($('#fa_user_newsletter_third_party_email_alert').attr('checked')) {
			$('#fa_user_newsletter_email_alert').attr('checked', $('#fa_user_newsletter_third_party_email_alert').attr('checked'));
			$('#fa_user_newsletter_email_alert').parent('span').addClass('checked');
		}
	});
	$("#fa_user_newsletter_email_alert").parent('span').on('click', function (e) {
		if (!$('#fa_user_newsletter_email_alert').parent('span').hasClass('checked')) {
			$('#fa_user_newsletter_email_alert').attr('checked', true);
		} else {
			$('#fa_user_newsletter_email_alert').attr('checked', false);
		}
		if (!$('#fa_user_newsletter_email_alert').attr('checked')) {
			$('#fa_user_newsletter_third_party_email_alert').attr('checked', false);
			$('#fa_user_newsletter_third_party_email_alert').parent('span').removeClass('checked');
		}
	});
	$("#fa_user_newsletter_third_party_email_alert").parent('span').on('change', function (e) {
		if ($('#fa_user_newsletter_third_party_email_alert').parent('span').hasClass('checked')) {
			$('#fa_user_newsletter_third_party_email_alert').attr('checked', true);
		} else {
			$('#fa_user_newsletter_third_party_email_alert').attr('checked', false);
		}

		if ($('#fa_user_newsletter_third_party_email_alert').attr('checked')) {
			$('#fa_user_newsletter_email_alert').attr('checked', $('#fa_user_newsletter_third_party_email_alert').attr('checked'));
			$('#fa_user_newsletter_email_alert').parent('span').addClass('checked');
		}
	});
	$("#fa_user_newsletter_email_alert").parent('span').on('change', function (e) {
		if ($('#fa_user_newsletter_email_alert').parent('span').hasClass('checked')) {
			$('#fa_user_newsletter_email_alert').attr('checked', true);
		} else {
			$('#fa_user_newsletter_email_alert').attr('checked', false);
		}
		if (!$('#fa_user_newsletter_email_alert').attr('checked')) {
			$('#fa_user_newsletter_third_party_email_alert').attr('checked', false);
			$('#fa_user_newsletter_third_party_email_alert').parent('span').removeClass('checked');
		}
	});
    $("#fa_user_newsletter").submit(function(event) {
    	// Stop form from submitting normally
        event.preventDefault();
    	$.ajax({
            type: "POST",
            url: "{{path('user_newsletter_ajax')}}",
            data: new FormData(this),
            contentType: false,
            processData:false,
        })
        .done(function(response) {
            if (response.success.length && response.user_id) {
                $("#fa_user_newsletter_email").val("");
                $('#createNewsletterBlockError').remove();
                $('<div data-alert="" class="alert-box success radius outside-tricky"><span class="alert-icon">&nbsp;</span>Thank you for subscribing with us.</div>').insertAfter('.newsletter-search-box').delay(3000).fadeOut();
                $(".search-box-col span").removeClass("checked");
                $("#fa_user_newsletter_email_alert").attr('checked', false);
                $("#fa_user_newsletter_third_party_email_alert").attr('checked', false);
                $("#fa_user_newsletter_email").removeClass("error");
            } else {
                $('#createNewsletterBlockError').remove();
                if (response.errorMessage.length) {
                    $("#fa_user_newsletter_email").addClass("error");
                    $('<div data-alert="" class="alert-box warning radius outside-tricky" style="padding: 21px 48px !important;"><span class="alert-icon">&nbsp;</span>'+response.errorMessage+'</div>').insertAfter('.newsletter-search-box').delay(3000).fadeOut();
                }
            }
        });
    });
</script>
{% endblock %}