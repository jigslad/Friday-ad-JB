{% if currentRoute in {0: 'ad_post_first_step', 1: 'ad_post_second_step', 2: 'ad_post_third_step', 3: 'ad_post_third_step_registration', 4: 'ad_post_fourth_step', 5: 'show_draft_ad', 6: 'ad_package_purchase', 7: 'show_cart', 8: 'cybersource_checkout', 9: 'ad_edit', 10: 'ad_promote' } %}
{% endif %}
<header class="header" id="header" role="banner" aria-label="Site header">
    {% if status_code == 200 %}
        {% if currentRoute == 'ad_detail_page' %}
            {% set zoneId = constant('Fa\\Bundle\\ContentBundle\\Repository\\BannerZoneRepository::ZONE_ABOVE_HEADER') %}
            {{ include('FaContentBundle:Banner:show.html.twig', {'zone_id': zoneId, 'otherParams':{'ad':adDetail}}) }}
            {% set zoneId = constant('Fa\\Bundle\\ContentBundle\\Repository\\BannerZoneRepository::ZONE_ABOVE_HEADER_TABLET') %}
            {{ include('FaContentBundle:Banner:show.html.twig', {'zone_id': zoneId, 'otherParams':{'ad':adDetail}}) }}
        {% else %}
            {% set zoneId = constant('Fa\\Bundle\\ContentBundle\\Repository\\BannerZoneRepository::ZONE_ABOVE_HEADER') %}
            {{ include('FaContentBundle:Banner:show.html.twig', {'zone_id': zoneId}) }}
            {% set zoneId = constant('Fa\\Bundle\\ContentBundle\\Repository\\BannerZoneRepository::ZONE_ABOVE_HEADER_TABLET') %}
            {{ include('FaContentBundle:Banner:show.html.twig', {'zone_id': zoneId}) }}
        {% endif %}
    {% endif %}
    <!--Top navigation Starts-->
    <div class="top-links top-navigation">
        <div class="row">
            <div class="container">
                <div class="navigation-right">
                    <ul class="navigation-right__block {{ app.user ? 'logged': 'login' }}">
                        {% if app.user %}
                            {% set messageRepository = fetch_repository('FaMessageBundle:Message') %}
                            {% set totalUnreadMsg = messageRepository.getMessageCount(app.user.getId(), 'all', fetch_container_instance()) %}
                            {% set userRole = fetch_repository('FaUserBundle:User').getUserRole(app.user.getId(), container) %}
                            {% set userCart = fetch_repository('FaPaymentBundle:Cart').getUserCart(app.user.getId(), container) %}
                            {% set userDetail = fetch_repository('FaPaymentBundle:Transaction').getCartDetail(userCart.getId()) %}
                            <li class="navigation-right__item menu-dropdown">
                                {% set myProfileUrl = container.get('fa_ad.manager.ad_routing').getProfilePageUrl(app.user.getId()) %}
                                <a class="arrow-icon navigation-right__link" href="{% if myProfileUrl %}{{ myProfileUrl }}{% else %}javascript:void(0);{% endif %}">
                                    Hello
                                    {% if app.user.getFullName() %}
                                        {{app.user.getFullName()}}
                                    {% else %}
                                        {{app.user.getUsername()}}
                                    {% endif %}

                                </a>
                                <div class="dropdown-content">
                                    <div class="dropdown-content__block user-profile">
                                        <div class="dropdown-content__profile {% if userRole == constant('Fa\\Bundle\\UserBundle\\Repository\\RoleRepository::ROLE_SELLER') %}private-user {% else %} business-user {% endif %} ">
                                            {% set userLogo = staticCall('Fa\\Bundle\\CoreBundle\\Manager\\CommonManager', 'getUserLogoByUserId', [fetch_container_instance(), app.user.getId(), true, true, app.user.getProfileName() ]) %}
{#                                                {{userLogo|replace({'<div': '<span', '</div>':'</span>'})|raw}}#}
                                            <img src="{{ userLogo }}" alt="{% if userRole == constant('Fa\\Bundle\\UserBundle\\Repository\\RoleRepository::ROLE_SELLER') %}private-user {% else %} business-user {% endif %}">
                                        </div>
                                        <h6 class="dropdown-content__user-name">
                                            Hello
                                            {% if app.user.getFullName() %}
                                                {{app.user.getFullName()}}
                                            {% else %}
                                                {{app.user.getUsername()}}
                                            {% endif %}
                                        </h6>
                                    </div>
                                    <div class="dropdown-content__block dashboard">
                                        <ul>
                                            <li class="dropdown-content__item">
                                                <a href="{{ path('dashboard_home') }}" class="dropdown-content__link home-icon">My Dashboard</a>
                                            </li>
                                            <li class="dropdown-content__item">
                                                <a href="{{ path('user_ad_message_all') }}" class="dropdown-content__link messages-icon">Messages</a>
                                            </li>
                                            <li class="dropdown-content__item">
                                                <a href="{{ path('user_review_list') }}" class="dropdown-content__link reviews-icon">Reviews</a>
                                            </li>
                                            <li class="dropdown-content__item">
                                                <a href="#" class="dropdown-content__link account-icon">Preferences</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="dropdown-content__block settings">
                                        <ul>
                                            <li class="dropdown-content__item">
                                                <a href="{{ path('manage_my_ads_active') }}" class="dropdown-content__link manage-item-icon">Manage my ads</a>
                                            </li>
                                            <li class="dropdown-content__item">
                                                <a href="{{ path('my_profile') }}" class="dropdown-content__link manage-profile-icon">Edit profile</a>
                                            </li>
                                            <li class="dropdown-content__item">
                                                <a href="{{ path('my_orders') }}" class="dropdown-content__link orders-icon">Orders
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="dropdown-content__block favourites">
                                        <ul>
                                            <li class="dropdown-content__item">
                                                <a href="{{ path('my_favourite') }}" class="dropdown-content__link my-favourites-icon">Favourites
                                                </a>
                                            </li>
                                            <li class="dropdown-content__item">
                                                <a href="{{ path('list_search_agent') }}" class="dropdown-content__link alerts-icon">Search alerts</a>
                                            </li>
                                            <li class="dropdown-content__item">
                                                <a href="{{ path('my_purchases') }}" class="dropdown-content__link purchase-icon">Purchases</a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="dropdown-content__block logout">
                                        <ul>
                                            <li class="dropdown-content__item">
                                                <a href="{{ path('logout') }}" class="dropdown-content__link" id="logout-header-id">Logout
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </li>
                            <li class="navigation-right__item">
                                {% if userDetail|length > 0 %}
                                    {% set userCartUrl = path('show_cart') %}
                                {% else %}
                                    {% set userCartUrl = 'javascript:void(0);' %}
                                {% endif %}
                                <a href="{{ userCartUrl }}" class="navigation-right__link basket-icon"></a>
{#                                    <a href="{{ userCartUrl }}" class="basket-icon"><span>({{ userDetail|length }})</span></a>|#}
                            </li>
                            <li class="navigation-right__item">
                                <a href="{{ path('user_ad_message_all') }}" id="inbox-header-id" class="navigation-right__link message-icon ga-widgetMessages"></a>
{#                                    <a href="{{ path('user_ad_message_all') }}" id="inbox-header-id" class="ga-widgetMessages">{{'Messages'|trans({}, 'frontend-header-usermenu')}} <span class="ga-widgetMessages">({{totalUnreadMsg}})</span> <span class="unread-msg ga-widgetMessages" id="total_unread_msg_icon_div" {% if totalUnreadMsg == 0 %} style="display:none" {% endif %}>&nbsp;</span></a>|#}
                            </li>
                            <li class="navigation-right__item">
                                <a href="{{ path('location_home_page', {'location': 'contact-us'}) }}" id="contact-header-id" class="navigation-right__link">Contact us</a>
                            </li>
                            {# need to disscuss about notification area with lauara and chaira #}
                            {# {{ render(controller('FaUserBundle:Dashboard:notification', { 'template': 'menu' })) }}#}
                        {% else %}
                            <li class="navigation-right__item">
                                <a href="{{ path('login') }}" id="login-header-id" class="navigation-right__link">{{'Log In'|trans({}, 'frontend-header-usermenu')}}</a>
                            </li>
                            <li class="navigation-right__item">
                                <a href="{{ path('fa_user_register') }}" id="register-header-id" class="navigation-right__link">{{'Register'|trans({}, 'frontend-header-usermenu')}}</a>
                            </li>
                            <li class="navigation-right__item">
                                    <a href="{{ path('location_home_page', {'location': 'contact-us'}) }}" id="contact-header-id" class="navigation-right__link">{{'Contact us'|trans({}, 'frontend-header-usermenu')}}</a>
                                </li>
                        {% endif %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!--Top navigation END-->
   {% set mobileDetectManager = container.get('fa.mobile.detect.manager') %}
    <!--Main navigation Starts-->
    <div class="main-navigation">
        <div class="row">
            <div class="container">
                <div class="main-navigation__block">
                    <div class="brand">
                        {# trade it logo  not configerd #}
                        <a href="{{ path('fa_frontend_homepage') }}" class="logo {% if showTiLogo %}tradeit-logo{% endif %}">
                            {% if showTiLogo %}
                                <img src="{{ asset_url('fafrontend/images/fad-ti-logo.png') }}" alt="{{ 'Friday-Ad'|trans({}, 'frontend') }}" />
                            {% else %}
                                <img src="{{ asset_url('fafrontend/images/fad-logo-new.svg') }}" alt="{{ 'Friday-Ad'|trans({}, 'frontend') }}" />
                            {% endif %}
                        </a>
                    </div>
                    <nav class="main-menu">
                        {% if mobileDetectManager.isTablet() %}
                            {{ render(controller('FaEntityBundle:Category:renderHeaderCategories', {'is_tablet':1, 'location': (currentRoute in {0: 'listing_page', 1: 'landing_page_category_location', 2: 'location_home_page'}  ? app.request.get('location') : null), 'searchParams': searchParams is defined ? searchParams : {}})) }}
                        {% elseif mobileDetectManager.isMobile() %}
                            {{ render(controller('FaEntityBundle:Category:renderHeaderCategories', {'is_tablet':0, 'is_mobile':1, 'location': (currentRoute in {0: 'listing_page', 1: 'landing_page_category_location', 2: 'location_home_page'} ? app.request.get('location') : null), 'searchParams': searchParams is defined ? searchParams : {}})) }}
                        {% else %}
                            {{ render(controller('FaEntityBundle:Category:renderHeaderCategories', {'is_tablet':0, 'is_mobile':0, 'location': (currentRoute in {0: 'listing_page', 1: 'landing_page_category_location', 2: 'location_home_page'} ? app.request.get('location') : null), 'searchParams': searchParams is defined ? searchParams : {}})) }}
                        {% endif %}
                    </nav>
                </div>
                <div class="search-sticky search-sticky-mobile">
                    <input type="text" class="search-sticky__input" value="" placeholder="What are you lookng for?" id="searchStickyKeey">
                </div>
            </div>
        </div>
    </div>
    <!--Main navigation END-->
   <div id="sticky_nav_top" style="display: none">
    <div class="nav-bg {% if currentRoute in {0: 'fa_frontend_homepage', 1: 'location_home_page', 2: 'listing_page', 3: 'landing_page_category_location', 4: 'landing_page_category'} %}homepage-nav{% endif %}">
        <div class="row">
            <div class="columns">
                {% if status_code == 200 and currentRoute is defined and currentRoute in {0: 'fa_frontend_homepage', 1: 'location_home_page', 2: 'listing_page', 3: 'landing_page_category_location', 4: 'landing_page_category'}  and not app.request.attributes.get('static_page') %}
                    <div id="sticky_nav" class="sticky">
                {% endif %}
                <nav class="top-bar" id="top_bar_nav" data-topbar="" data-options="sticky_on: large">
                    <ul class="title-area">
                        <li class="name">
                        <h1>
                             <a href="{{ path('fa_frontend_homepage') }}" class="logo {% if showTiLogo %}tradeit-logo{% endif %}">
                                 {% if showTiLogo %}
                                     <img src="{{ asset_url('fafrontend/images/fad-ti-logo.png') }}" alt="{{ 'Friday-Ad'|trans({}, 'frontend') }}" />
                                 {% else %}
                                     <img src="{{ asset_url('fafrontend/images/fad-logo-new.svg') }}" alt="{{ 'Friday-Ad'|trans({}, 'frontend') }}" />
                                 {% endif %}
                             </a>
                        </h1>
                        </li>
                        <!-- Remove the class "menu-icon" to get rid of menu icon. Take out "Menu" to just have icon alone -->
                        <li class="toggle-topbar menu-icon" id="mobile_menu_li"><a href="javascript:void(0);"><span class="menu" id="top_bar_nav_menu_span"></span></a></li>
                        {% if currentRoute not in {0: 'cybersource_checkout', 1: 'fa_frontend_homepage'} %}
                            <li class="show-for-small-only search-icon" id="mobile_search_li"><a href="javascript:void(0)" class="search">Search</a></li>
                        {% endif %}
                    </ul>
                    <section class="top-bar-section">
                        <!-- Right Nav Section -->
                       <div class="tablet-menu">
                            {% if mobileDetectManager.isTablet() %}
                                {{ render(controller('FaEntityBundle:Category:renderHeaderCategories', {'is_tablet':1, 'location': (currentRoute in {0: 'listing_page', 1: 'landing_page_category_location', 2: 'location_home_page'}  ? app.request.get('location') : null), 'searchParams': searchParams is defined ? searchParams : {}})) }}
                            {% elseif mobileDetectManager.isMobile() %}
                                {{ render(controller('FaEntityBundle:Category:renderHeaderCategories', {'is_tablet':0, 'is_mobile':1, 'location': (currentRoute in {0: 'listing_page', 1: 'landing_page_category_location', 2: 'location_home_page'} ? app.request.get('location') : null), 'searchParams': searchParams is defined ? searchParams : {}})) }}
                            {% else %}
                                {{ render(controller('FaEntityBundle:Category:renderHeaderCategories', {'is_tablet':0, 'is_mobile':0, 'location': (currentRoute in {0: 'listing_page', 1: 'landing_page_category_location', 2: 'location_home_page'} ? app.request.get('location') : null), 'searchParams': searchParams is defined ? searchParams : {}})) }}
                            {% endif %}
                        </div>

                            {% if app.user %}
                             <ul class="show-for-small-only login-menu">
                                <li>
                                	{% set myProfileUrl = container.get('fa_ad.manager.ad_routing').getProfilePageUrl(app.user.getId()) %}
                                    <a href="{% if myProfileUrl %}{{ myProfileUrl }}{% else %}javascript:void(0);{% endif %}" class="logged-in-user">
                                    {% if app.user.getFirstName() or  app.user.getLastName() %}
                                        {{app.user.getFirstName()}} {{app.user.getLastName()}}
                                    {% else %}
                                        {{app.user.getUsername()}}
                                    {% endif %}
                                    </a>
                                </li>
                                {% if mobileDetectManager.isMobile() and not mobileDetectManager.isTablet() %}
                                {{ render(controller('FaUserBundle:Dashboard:notification', { 'template': 'mobile_menu' })) }}
                                {% endif %}
                                <li><a href="{{ path('user_ad_message') }}" id="mob-inbox-header-id" class="ga-widgetMessages">{{'MESSAGES'|trans({}, 'inbox')}}{% if totalUnreadMsg > 0 %}&nbsp;<span class="notification-digit ga-widgetMessages">({{totalUnreadMsg}})</span>{% endif %}</a></li>

                                {% if userDetail|length > 0 %}
	                            <li>
                                    <a href="{{ path('show_cart') }}">Cart <span class="notification-digit">({{ userDetail|length }})</span></a>
                                </li>
                                {% endif %}

                                <li><a href="{{ path('logout') }}" id="mob-logout-header-id">{{'Log Out'|trans({}, 'frontend-top-menu')}}</a></li>
                            </ul>
                                {% else %}
                            <ul class="show-for-small-only login-menu login-reg-flex">
                                <li><a href="{{ path('login') }}" id="mob-login-header-id">{{'Log In'|trans({}, 'frontend-top-menu')}}</a></li>
                                <li><a href="{{ path('fa_user_register') }}" id="mob-register-header-id">{{'Register'|trans({}, 'frontend-top-menu')}}</a></li>
                            </ul>
                                {% endif %}
                        <ul class="show-for-small-only login-menu">
                            <li><a href="{{ path('location_home_page', {'location': 'contact-us'}) }}" id="mob-contact-header-id">{{'Contact us'|trans({}, 'frontend-top-menu')}}</a></li>
                        </ul>

                        <ul class="right place-item ga-buttonPAA">
                            <li class="place-item-btn ga-buttonPAA"><a class="ga-buttonPAA" href="{{ path('ad_post_first_step') }}" title="{{ 'Place An Ad'|trans({}, 'frontend-top-menu') }}">{{ 'Place An Ad'|trans({}, 'frontend-top-menu') }}</a></li>
                        </ul>
                    </section>
                </nav>
                {% if status_code == 200 and currentRoute is defined and currentRoute in {0: 'fa_frontend_homepage', 1: 'location_home_page', 2: 'listing_page', 3: 'landing_page_category_location', 4: 'landing_page_category'} %}
                    </div>
                {% endif %}
            </div>
        </div>
        <div class="dropdown-bg"></div>
    </div>
</div>
    {% if status_code == 200 %}
        {% if currentRoute not in {0: 'fa_frontend_homepage', 1: 'location_home_page', 2: 'cybersource_checkout'} %}
            {{ render(controller('FaAdBundle:AdList:topSearch', { 'searchParams': searchParams is defined ? searchParams : {} } )) }}
        {% endif %}
    {% endif %}
</header>
<script>
    // Scroll after style adding
    $(window).scroll(function() {
        var scroll = $(window).scrollTop();
        if (window.matchMedia("(min-width: 768px)").matches) {
            if (scroll >= 105) {
                $('.header').addClass('scrolled');
            } else {
                $('.header').removeClass('scrolled')
            }
        } else {
            if (scroll >= 150) {
                $('.header').addClass('scrolled');
            } else {
                $('.header').removeClass('scrolled')
            }
        }
    });
    $('#megaDropdown').click(function(e) {
        $(this).toggleClass('rotate-icon')
        $(this).siblings('.nav-dropdown').toggleClass('menu-toggle');
        e.stopPropagation();
    });
    $('#mobileMegaDropdown').click(function(e) {
        $(this).toggleClass('menu-green-icon')
        $('.main-navigation__block').toggleClass('pos-static');
        $('.nav-mobile .nav-dropdown').toggleClass('menu-toggle');
        e.stopPropagation();
    });

    $('.accordion-link').click(function(event) {
        if ($('.menu-accordion').hasClass('show-accordion')) {
            $('.accordion-link').not($(this)).removeClass('active');
            $('.nav-dropdown__block').not($(this).next()).slideUp(300);
        }
        $(this).toggleClass('active').next().slideToggle(300);
    });
    $('.nav-mobile .nav-dropdown__link').click(function(event) {
        $(this).toggleClass('actived').next().addClass('nav-dropdown-menu-show');
    });
    $('.nav-mobile .nav-dropdown__menu--link').click(function(event) {
        $(this).toggleClass('actived').next().addClass('nav-dropdown-third-show');
    });
    $('.goBack').click(function(event) {
        var level = $(this).attr("level");
        if (level == 2) {
            $('.nav-dropdown__menu').removeClass('nav-dropdown-menu-show');
        } else {
            $('.nav-dropdown-third').removeClass('nav-dropdown-third-show');
        }
    });
</script>